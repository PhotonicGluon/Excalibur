Added a lot more tests
