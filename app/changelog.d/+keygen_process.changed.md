Changed key generation process to include username
